<section class="wa-card">
  <div class="wa-header-top">
    <div class="wa-title-wrap">
      <ng-container *ngIf="!editingTitle; else editTpl">
        <h2 class="wa-title">{{ title }}</h2>
        <button class="wa-btn icon small" (click)="startEdit()">✎</button>
      </ng-container>

      <ng-template #editTpl>
        <div class="wa-edit-wrap">
          <input
            class="wa-input small"
            type="text"
            [(ngModel)]="titleDraft"
            (keyup.enter)="trySave()"
            (blur)="trySave()"
            [class.invalid]="invalidTitle"
          />
          <button class="wa-btn small" (click)="trySave()">✔</button>
          <button class="wa-btn danger small" (click)="cancelEdit()">✕</button>
        </div>
      </ng-template>
    </div>
  </div>

  <div class="wa-stack">
    <div>
      <label class="wa-label">Globalne instrukcije</label>
      <textarea
        class="wa-input"
        [ngModel]="globalInstruction"
        (ngModelChange)="onGlobalInstructionInput($event)"
        rows="4"
        placeholder="Npr: Koristi stručan i koncizan ton…"
      ></textarea>
    </div>

    <div class="wa-actions">
      <button class="wa-btn" (click)="addSection.emit()">
        ＋ Dodaj sekciju
      </button>
      <button class="wa-btn">Pogledaj ceo dokument</button>
    </div>
  </div>
</section>
