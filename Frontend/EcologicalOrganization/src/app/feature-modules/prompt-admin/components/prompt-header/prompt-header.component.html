<section class="wa-card pa-card">
  <h3 class="pa-card-title">Osnovni podaci prompta</h3>

  <div class="pa-grid-3">
    <div class="left">
      <div class="pa-field">
        <label class="wa-label">Naziv prompta</label>

        <ng-container *ngIf="!editingName; else editNameTpl">
          <div class="wa-title-wrap">
            <h2 class="wa-title">{{ nameDraft || "(bez naziva)" }}</h2>
            <button
              class="wa-btn icon small"
              type="button"
              (click)="startEditName()"
              aria-label="Uredi naslov"
            >
              ✎
            </button>
          </div>
        </ng-container>

        <ng-template #editNameTpl>
          <div class="wa-edit-wrap">
            <input
              class="wa-input small"
              type="text"
              [(ngModel)]="nameDraft"
              (keyup.enter)="trySaveName()"
              (blur)="trySaveName()"
              [class.invalid]="invalidName"
              placeholder="Unesi naslov…"
            />
            <button class="wa-btn small" (click)="trySaveName()">✔</button>
            <button
              class="wa-btn danger small"
              *ngIf="!isNewPrompt"
              (click)="cancelEditName()"
            >
              ✕
            </button>
          </div>
        </ng-template>
      </div>

      <div class="pa-field">
        <label class="wa-label">Tip dokumenta</label>

        <ng-container *ngIf="isNewPrompt; else fixedDocTypeTpl">
          <select
            class="wa-input small wa-doc-type-select"
            [disabled]="!documentTypes?.length"
            [ngModel]="documentTypeId"
            (ngModelChange)="onDocTypeChanged($event)"
          >
            <option *ngFor="let dt of documentTypes" [value]="dt.id">
              {{ dt.name === "Default" ? "" : dt.name }}
            </option>
          </select>
        </ng-container>

        <ng-template #fixedDocTypeTpl>
          <div class="pa-doc-type" [title]="docTypeLabel">
            {{ docTypeLabel }}
          </div>
        </ng-template>
      </div>
    </div>

    <div class="action-buttons-right" *ngIf="!isNewPrompt">
      <div class="pa-field pa-new-version">
        <label class="wa-label">&nbsp;</label>
        <button
          class="wa-btn full"
          type="button"
          (click)="onCreateNewVersion()"
        >
          + Kreiraj novu verziju
        </button>
      </div>

      <div class="pa-field pa-delete">
        <label class="wa-label">&nbsp;</label>
        <button
          class="wa-btn danger full"
          type="button"
          (click)="onDeletePrompt()"
        >
          Obriši prompt
        </button>
      </div>
    </div>

    <ng-template [ngIf]="isNewPrompt">
      <div class="action-buttons-right">
        <div class="pa-field">
          <label class="wa-label">&nbsp;</label>
          <button class="wa-btn full" type="button" (click)="onSaveNewPrompt()">
            Sačuvaj novi prompt
          </button>
        </div>
      </div>
    </ng-template>
  </div>
</section>
