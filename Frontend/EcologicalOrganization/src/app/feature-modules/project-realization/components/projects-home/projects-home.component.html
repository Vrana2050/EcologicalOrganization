<!-- Header bar -->
<div class="header">
  <div class="status-tabs">
    <a
      class="status-tab"
      [class.active]="status === 'active'"
      (click)="switchStatus('active')"
      >Active</a
    >
    <a
      class="status-tab"
      [class.active]="status === 'archived'"
      (click)="switchStatus('archived')"
      >Archived</a
    >
  </div>
  <button
    class="primary-btn"
    type="button"
    [routerLink]="['/project-realization/new']"
  >
    New project
  </button>
</div>

<!-- Title -->
<h1 class="page-title">
  {{ status === "active" ? "Active projects" : "Archived projects" }}
</h1>

<!-- Loading / Error / Empty states -->
<div *ngIf="loading" class="muted" style="margin: 8px 0">Loading…</div>
<div
  *ngIf="!loading && errorMsg"
  class="muted"
  style="margin: 8px 0; color: #b91c1c"
>
  {{ errorMsg }}
</div>
<div
  *ngIf="!loading && !errorMsg && projects.length === 0"
  class="muted"
  style="margin: 8px 0"
>
  No projects found.
</div>

<!-- Grid of cards -->
<div class="cards-grid" *ngIf="!loading && !errorMsg && projects.length">
  <article
    class="card"
    *ngFor="let p of projects"
    [routerLink]="['/project-realization', p.id]"
    role="button"
    tabindex="0"
  >
    <div class="card-head">
      <h3 class="card-title">{{ p.name }}</h3>

      <span class="created">
        Created: {{ p.startDate | date : "d-MMM-y" }}
      </span>
    </div>

    <ul class="meta">
      <li class="meta-row" *ngIf="p.location">
        <span class="icon">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path
              d="M12 22s7-5.33 7-12A7 7 0 1 0 5 10c0 6.67 7 12 7 12Z"
              stroke="currentColor"
              stroke-width="1.6"
            />
            <circle
              cx="12"
              cy="10"
              r="2.5"
              stroke="currentColor"
              stroke-width="1.6"
            />
          </svg>
        </span>
        <span>{{ p.location }}</span>
      </li>

      <li class="meta-row">
        <span class="icon" aria-hidden="true">
          <!-- clock icon -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <circle
              cx="12"
              cy="12"
              r="9"
              stroke="currentColor"
              stroke-width="1.6"
            />
            <path
              d="M12 7v5l3 2"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>
        <span>
          {{ durationDays(p) }} days duration{{ p.endDate ? "" : " so far" }}
        </span>
      </li>
    </ul>
  </article>
</div>

<!-- Pagination -->
<div class="pagination" *ngIf="!loading && totalPages > 1">
  <button class="pager" [disabled]="page === 1" (click)="goToPage(1)">«</button>
  <button class="pager" [disabled]="page === 1" (click)="goToPage(page - 1)">
    ‹
  </button>

  <ng-container *ngFor="let p of visiblePages">
    <button
      *ngIf="p !== '…'; else ellipsis"
      class="page"
      [class.active]="p === page"
      (click)="goToPage(p)"
      [attr.aria-current]="p === page ? 'page' : null"
    >
      {{ p }}
    </button>
    <ng-template #ellipsis>
      <span class="ellipsis">…</span>
    </ng-template>
  </ng-container>

  <button
    class="pager"
    [disabled]="page === totalPages"
    (click)="goToPage(page + 1)"
  >
    ›
  </button>
  <button
    class="pager"
    [disabled]="page === totalPages"
    (click)="goToPage(totalPages)"
  >
    »
  </button>
</div>
